<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <input type="text" id="title" placeholder="Title" />
    <input type="text" id="message" placeholder="Message" />
    <button id="add">Add</button>
    <button id="clear">Clear</button>
    <ul id="list"></ul>
  </body>
  <script>
    var title = document.querySelector("#title");
    var message = document.querySelector("#message");
    var add = document.querySelector("#add");
    var clear = document.querySelector("#clear");
    const update = (obj) => {
      try {
        for (var item in obj) {
          var li = document.createElement("li");
          var title = item;
          var message = obj[item];
          li.innerHTML += "<p><b>" + title + ":</b>  " + message + "</p>";
          document.querySelector("#list").append(li);
        }
      } catch ({ message }) {
        console.error(message);
      }
    };
    const apiRequest = async (route = "", method = "GET") => {
      var send = await fetch("/api/" + route, {
        method: method,
        headers: {
          Accept: "application/json",
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          key: title.value,
          value: message.value,
        }),
      })
        .then((response) => response.json())
        .then((data) => update(data));
    };
    add.addEventListener("click", () => apiRequest("add", "POST"));
    clear.addEventListener("click", () => apiRequest("clear", "POST"));
  </script>
</html>
