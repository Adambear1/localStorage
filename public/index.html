<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <input type="text" id="title" placeholder="Title" />
    <input type="text" id="message" placeholder="Message" />
    <button id="add">Add</button>
    <button id="clear">Clear</button>
    <ul id="list"></ul>
  </body>
  <script>
    var title = document.querySelector("#title");
    var message = document.querySelector("#message");
    var add = document.querySelector("#add");
    var clear = document.querySelector("#clear");
    var list = document.querySelector("#list");
    var remove = "<button type='btn' id='remove'>üóëÔ∏è</button>";

    const update = (obj) => {
      try {
        for (var child of list.childNodes) {
          console.log(child);
          child.remove();
        }
        for (var item in obj) {
          var li = document.createElement("li");
          var title = item;
          var message = obj[item];
          li.setAttribute("id", item);
          li.innerHTML +=
            "<p><b>" + title + ":</b>  " + message + "</p>" + "   " + remove;
          list.append(li);
        }
      } catch ({ message }) {
        console.error(message);
      }
    };
    const apiRequest = async (route = "", method = "POST") => {
      var send = await fetch("/api/" + route, {
        method,
        headers: {
          Accept: "application/json",
          "Content-Type": "application/json",
        },
        body:
          title.value || message.value
            ? JSON.stringify({
                key: title.value,
                value: message.value,
              })
            : "",
      })
        .then((response) => response.json())
        .then((data) => {
          update(data);
        });
    };
    add.addEventListener("click", () => apiRequest("add"));
    clear.addEventListener("click", () => apiRequest("clear"));

    apiRequest();
  </script>
</html>
